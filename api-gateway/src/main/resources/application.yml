# All configurations now come from Config Server
# This file can be empty or contain only local overrides

# Optional: Local development overrides
# spring:
#   profiles:
#     active: dev





#server:
#  port: 8080
#
#spring:
#  application:
#    name: api-gateway
#
#  # Redis Configuration
#  data:
#    redis:
#      host: localhost
#      port: 6379
#
#  # Spring Cloud Gateway Configuration
#  cloud:
#    gateway:
#      # Enable discovery locator (automatic routing based on service names)
#      discovery:
#        locator:
#          enabled: true
#          lower-case-service-id: true
#
#      # Define routes manually for better control
#      routes:
#        # User Service Routes
#        - id: user-service
#          uri: lb://user-service  # lb = load balanced
#          predicates:
#            - Path=/api/users/**
#          filters:
#            - RewritePath=/api/users(?<segment>/?.*), /users$\{segment}
#            - name: CircuitBreaker
#              args:
#                name: userServiceCircuitBreaker
#                fallbackUri: forward:/fallback/users
#            - name: RequestRateLimiter
#              args:
#                redis-rate-limiter:
#                  replenishRate: 10    # tokens per second
#                  burstCapacity: 20    # max tokens
#                  requestedTokens: 1   # tokens per request
#
#        # Product Service Routes
#        - id: product-service
#          uri: lb://product-service
#          predicates:
#            - Path=/api/products/**
#          filters:
#            - RewritePath=/api/products(?<segment>/?.*), /products$\{segment}
#            - name: CircuitBreaker
#              args:
#                name: productServiceCircuitBreaker
#                fallbackUri: forward:/fallback/products
#            - name: RequestRateLimiter
#              args:
#                redis-rate-limiter:
#                  replenishRate: 10
#                  burstCapacity: 20
#                  requestedTokens: 1
#
#        # Order Service Routes
#        - id: order-service
#          uri: lb://order-service
#          predicates:
#            - Path=/api/orders/**
#          filters:
#            - RewritePath=/api/orders(?<segment>/?.*), /orders$\{segment}
#            - name: CircuitBreaker
#              args:
#                name: orderServiceCircuitBreaker
#                fallbackUri: forward:/fallback/orders
#            - name: RequestRateLimiter
#              args:
#                redis-rate-limiter:
#                  replenishRate: 5     # Lower rate for orders
#                  burstCapacity: 10
#                  requestedTokens: 1
#
#        # Health Check Route (bypass filters)
#        - id: health-check
#          uri: lb://order-service
#          predicates:
#            - Path=/api/health/**
#          filters:
#            - RewritePath=/api/health(?<segment>/?.*), /health$\{segment}
#
#      # Global CORS Configuration
#      globalcors:
#        corsConfigurations:
#          '[/**]':
#            allowedOrigins: "*"
#            allowedMethods:
#              - GET
#              - POST
#              - PUT
#              - DELETE
#              - PATCH
#              - OPTIONS
#            allowedHeaders: "*"
#            exposedHeaders:
#              - Authorization
#            maxAge: 3600
#
#      # Default filters applied to all routes
#      default-filters:
#        - name: Retry
#          args:
#            retries: 3
#            statuses: BAD_GATEWAY,GATEWAY_TIMEOUT
#            methods: GET,POST
#            backoff:
#              firstBackoff: 50ms
#              maxBackoff: 500ms
#              factor: 2
#              basedOnPreviousValue: false
#
## Eureka Client Configuration
#eureka:
#  client:
#    service-url:
#      defaultZone: http://localhost:8761/eureka/
#    fetch-registry: true
#    register-with-eureka: true
#  instance:
#    prefer-ip-address: true
#    instance-id: ${spring.application.name}:${random.value}
#
## Actuator Configuration
#management:
#  endpoints:
#    web:
#      exposure:
#        include: health,gateway,circuitbreakers,metrics
#  endpoint:
#    health:
#      show-details: always
#    gateway:
#      enabled: true
#
## Logging
#logging:
#  level:
#    org.springframework.cloud.gateway: DEBUG
#    reactor.netty: INFO